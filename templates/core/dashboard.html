{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - ProHacker Academy{% endblock %}

{% block extra_css %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@500;700;900&display=swap');

  /* Matrix Rain + Scanline – Only Dark Mode */
  #matrix-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; pointer-events: none; }
  .scanline { 
    position: fixed; top: 0; left: 0; width: 100%; height: 4px; 
    background: rgba(0,255,255,0.15); animation: scan 8s linear infinite; 
    z-index: -9; pointer-events: none; 
  }
  @keyframes scan { from { transform: translateY(-100%); } to { transform: translateY(100vh); } }

  /* Glitch Effect – Only Dark Mode */
  .glitch { 
    position: relative; 
    animation: glitch 4s infinite; 
    display: inline-block;
  }
  .glitch::before, .glitch::after { 
    content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
  }
  .glitch::before { animation: glitch-1 0.5s infinite; color: #00ffff; left: 2px; text-shadow: -2px 0 #ff00ff; }
  .glitch::after { animation: glitch-2 0.5s infinite; color: #ff00ff; left: -2px; text-shadow: 2px 0 #00ffff; }

  @keyframes glitch { 0%,100% { transform: translate(0); } 20% { transform: translate(-3px,3px); } 40% { transform: translate(3px,-3px); } }
  @keyframes glitch-1 { 0% { clip: rect(20px,9999px,40px,0); } 100% { clip: rect(80px,9999px,100px,0); } }
  @keyframes glitch-2 { 0% { clip: rect(40px,9999px,60px,0); } 100% { clip: rect(10px,9999px,80px,0); } }

  /* Typing Cursor */
  .typing { 
    overflow: hidden; border-right: 3px solid #06b6d4; white-space: nowrap; 
    animation: typing 4s steps(20) infinite; width: 0; display: inline-block;
  }
  @keyframes typing { from { width: 0 } to { width: 100% } }
  .blink { animation: blink 1s infinite; }
  @keyframes blink { 50% { opacity: 0; } }

  /* Progress Glow */
  .progress-glow { box-shadow: 0 0 20px currentColor; }

  /* Card Hover */
  .card-hover { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
  .card-hover:hover { transform: translateY(-16px) scale(1.02); box-shadow: 0 32px 64px -12px rgba(6, 182, 212, 0.3); }
</style>
{% endblock %}

{% block content %}

<!-- FULL MATRIX + SCANLINE (Only Dark Mode) -->
<canvas id="matrix-bg" class="fixed inset-0 opacity-0 dark:opacity-20"></canvas>
<div class="scanline hidden dark:block"></div>

<div class="min-h-screen 
            bg-gradient-to-b from-white via-gray-50 to-indigo-50 
            dark:from-black dark:via-gray-950 dark:to-black 
            text-gray-900 dark:text-white">

  <!-- Floating Particles -->
  <div class="fixed inset-0 pointer-events-none opacity-10 dark:opacity-15">
    <div class="absolute top-20 left-10 text-9xl animate-bounce text-indigo-600 dark:text-cyan-400">Lightning</div>
    <div class="absolute top-1/3 right-20 text-8xl animate-pulse text-purple-600 dark:text-pink-500">Crossbones</div>
    <div class="absolute bottom-40 left-1/4 text-7xl animate-spin-slow text-emerald-600 dark:text-purple-400">Gear</div>
  </div>

  <div class="max-w-7xl mx-auto px-6 py-10">

    <!-- WELCOME HEADER -->
    <div class="relative mb-12">
      <div class="absolute inset-0 
                  bg-gradient-to-r from-indigo-500/10 via-purple-600/10 to-pink-600/10 
                  dark:from-cyan-500/20 dark:via-purple-600/20 dark:to-pink-600/20 
                  blur-3xl opacity-30"></div>
      <div class="relative bg-white/90 dark:bg-gray-900/80 backdrop-blur-2xl rounded-3xl 
                  border border-indigo-200 dark:border-cyan-500/50 p-10 shadow-2xl">
        <div class="flex flex-col lg:flex-row justify-between items-center gap-8">
          <div>
            <h1 class="text-5xl md:text-7xl font-black tracking-tight">
              <span class="block text-gray-900 dark:hidden">WELCOME BACK,</span>
              <span class="hidden dark:block glitch" data-text="WELCOME BACK">WELCOME BACK</span>
              
              <span class="block text-4xl md:text-6xl mt-2 
                         text-indigo-600 dark:text-cyan-300">
                <span class="typing">{{ user.username|default:"hacker_1337" }}</span>
                <span class="blink">|</span>
              </span>
            </h1>
            <p class="mt-4 text-xl text-purple-700 dark:text-pink-400 font-handwritten">
              The system recognizes your elite status
            </p>
          </div>
          <a href="#" class="px-12 py-6 
                          bg-gradient-to-r from-indigo-600 to-purple-600 
                          dark:from-cyan-500 dark:to-purple-600 
                          rounded-full font-black text-2xl text-white shadow-2xl 
                          hover:scale-110 hover:rotate-6 transition-all duration-500 
                          border-4 border-white/20 hover:border-white 
                          flex items-center gap-4 group/btn">
            <i class="fas fa-terminal text-3xl group-hover/btn:animate-pulse"></i>
            <span>RESUME MISSION</span>
          </a>
        </div>
      </div>
    </div>

    <!-- STATS CARDS -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-12">
      <div class="card-hover bg-white dark:bg-gray-900/70 backdrop-blur-xl rounded-3xl p-8 
                  border border-indigo-200 dark:border-cyan-500/30 text-center">
        <div class="text-6xl mb-4 opacity-20"><i class="fas fa-scroll"></i></div>
        <div class="text-5xl font-black text-indigo-700 dark:text-cyan-400">12</div>
        <div class="text-sm uppercase tracking-wider text-gray-600 dark:text-gray-400">Active Missions</div>
        <div class="text-emerald-600 dark:text-green-400 text-sm mt-2">+3 this week</div>
      </div>
      <div class="card-hover bg-white dark:bg-gray-900/70 backdrop-blur-xl rounded-3xl p-8 
                  border border-purple-200 dark:border-purple-500/30 text-center">
        <div class="text-6xl mb-4 opacity-20"><i class="fas fa-clock"></i></div>
        <div class="text-5xl font-black text-purple-700 dark:text-purple-400">87<span class="text-3xl">h</span></div>
        <div class="text-sm uppercase tracking-wider text-gray-600 dark:text-gray-400">Total Hacked Time</div>
        <div class="text-purple-600 dark:text-purple-300 text-sm mt-2">+12.5h</div>
      </div>
      <div class="card-hover bg-white dark:bg-gray-900/70 backdrop-blur-xl rounded-3xl p-8 
                  border border-pink-200 dark:border-pink-500/30 text-center">
        <div class="text-6xl mb-4 opacity-20"><i class="fas fa-certificate"></i></div>
        <div class="text-5xl font-black text-pink-700 dark:text-pink-400">8</div>
        <div class="text-sm uppercase tracking-wider text-gray-600 dark:text-gray-400">Certificates</div>
        <div class="text-pink-600 dark:text-pink-300 text-sm mt-2">OSCP Loading...</div>
      </div>
      <div class="card-hover bg-white dark:bg-gray-900/70 backdrop-blur-xl rounded-3xl p-8 
                  border border-orange-200 dark:border-red-500/30 text-center">
        <div class="text-6xl mb-4 opacity-20"><i class="fas fa-fire"></i></div>
        <div class="text-5xl font-black text-orange-700 dark:text-red-400">42</div>
        <div class="text-sm uppercase tracking-wider text-gray-600 dark:text-gray-400">Day Streak</div>
        <div class="text-red-600 dark:text-orange-400 text-sm mt-2 font-bold">DO NOT BREAK</div>
      </div>
    </div>

    <div class="grid lg:grid-cols-3 gap-8">

      <!-- MAIN PROGRESS + TERMINAL -->
      <div class="lg:col-span-2 space-y-8">

        <!-- Progress Bars -->
        <div class="bg-white dark:bg-gray-900/70 backdrop-blur-xl rounded-3xl p-8 
                    border border-indigo-200 dark:border-cyan-500/30 shadow-2xl">
          <h3 class="text-3xl font-black mb-8 text-transparent bg-clip-text 
                     bg-gradient-to-r from-indigo-600 to-purple-600 
                     dark:from-cyan-400 dark:to-purple-500">
            Current Operations
          </h3>
          <div class="space-y-6">
            <div>
              <div class="flex justify-between mb-2">
                <span class="text-indigo-700 dark:text-cyan-300">Advanced Binary Exploitation</span>
                <span class="text-purple-700 dark:text-pink-400 font-bold">87%</span>
              </div>
              <div class="h-6 bg-gray-200 dark:bg-gray-800 rounded-full overflow-hidden">
                <div class="h-full bg-gradient-to-r from-indigo-600 to-purple-600 
                            dark:from-cyan-500 dark:to-purple-600 rounded-full progress-glow" style="width:87%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between mb-2">
                <span class="text-emerald-700 dark:text-green-300">Kernel Pwn Mastery</span>
                <span class="text-emerald-700 dark:text-green-400 font-bold">63%</span>
              </div>
              <div class="h-6 bg-gray-200 dark:bg-gray-800 rounded-full overflow-hidden">
                <div class="h-full bg-gradient-to-r from-emerald-600 to-teal-600 
                            dark:from-green-500 dark:to-emerald-600 rounded-full progress-glow" style="width:63%"></div>
              </div>
            </div>
            <div>
              <div class="flex justify-between mb-2">
                <span class="text-yellow-700 dark:text-yellow-300">AI Red Teaming</span>
                <span class="text-yellow-700 dark:text-yellow-400 font-bold">45%</span>
              </div>
              <div class="h-6 bg-gray-200 dark:bg-gray-800 rounded-full overflow-hidden">
                <div class="h-full bg-gradient-to-r from-yellow-500 to-orange-600 
                            dark:from-yellow-500 dark:to-orange-600 rounded-full progress-glow" style="width:45%"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Live Terminal Feed -->
        <div class="bg-gray-100 dark:bg-black/80 backdrop-blur-xl rounded-3xl border-2 
                    border-indigo-200 dark:border-green-500/50 p-6 shadow-2xl">
          <div class="flex items-center gap-4 mb-4">
            <div class="flex gap-2">
              <div class="w-4 h-4 rounded-full bg-red-500"></div>
              <div class="w-4 h-4 rounded-full bg-yellow-500"></div>
              <div class="w-4 h-4 rounded-full bg-green-500"></div>
            </div>
            <span class="text-indigo-700 dark:text-green-400 font-mono">root@prohacker:~$ live_log</span>
          </div>
          <div class="font-mono text-sm space-y-2 text-indigo-700 dark:text-green-400 h-64 overflow-y-auto">
            <p><span class="text-purple-700 dark:text-cyan-400">[07:12]</span> Connected to target 192.168.13.37</p>
            <p><span class="text-emerald-700 dark:text-yellow-400">[07:15]</span> Privilege escalation successful to root</p>
            <p><span class="text-pink-700 dark:text-pink-400">[07:18]</span> Exfiltrated /etc/shadow</p>
            <p><span class="text-green-700 dark:text-green-400">[07:20]</span> Deployed persistence backdoor</p>
            <p><span class="text-red-700 dark:text-red-400">[07:22]</span> Detected by EDR — evaded</p>
            <p><span class="text-purple-700 dark:text-purple-400">[LIVE]</span> Waiting for next command...</p>
          </div>
        </div>
      </div>

      <!-- RIGHT SIDEBAR -->
      <div class="space-y-8">

        <!-- Next Targets -->
        <div class="bg-white dark:bg-gradient-to-br dark:from-purple-900/40 dark:to-pink-900/30 
                    rounded-3xl border border-indigo-200 dark:border-purple-500/50 p-8 shadow-2xl">
          <h3 class="text-3xl font-black 
                     text-indigo-700 dark:text-purple-400 mb-6">
            Next Targets
          </h3>
          <div class="space-y-4">
            <div class="bg-gray-50 dark:bg-black/50 rounded-2xl p-5 border 
                        border-indigo-300 dark:border-purple-600">
              <h4 class="text-purple-700 dark:text-pink-300 font-bold">Windows Kernel Exploitation</h4>
              <p class="text-gray-600 dark:text-gray-400 text-sm">By pwnie • Advanced • $199</p>
            </div>
            <div class="bg-gray-50 dark:bg-black/50 rounded-2xl p-5 border 
                        border-indigo-300 dark:border-cyan-600">
              <h4 class="text-indigo-700 dark:text-cyan-300 font-bold">LLM Jailbreaking Masterclass</h4>
              <p class="text-gray-600 dark:text-gray-400 text-sm">By grok_hacker • FREE this week</p>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white dark:bg-gradient-to-br dark:from-cyan-900/40 dark:to-blue-900/30 
                    rounded-3xl border border-indigo-200 dark:border-cyan-500/50 p-8 shadow-2xl">
          <h3 class="text-3xl font-black text-indigo-700 dark:text-cyan-400 mb-6">Command Center</h3>
          <div class="grid grid-cols-2 gap-4">
            <a href="#" class="p-6 bg-indigo-100 dark:bg-cyan-900/50 rounded-2xl text-center 
                             font-bold text-indigo-700 dark:text-cyan-300 
                             hover:scale-110 hover:-rotate-3 transition-all duration-300">
              <i class="fas fa-scroll text-3xl mb-2 block"></i>Missions
            </a>
            <a href="#" class="p-6 bg-purple-100 dark:bg-purple-900/50 rounded-2xl text-center 
                             font-bold text-purple-700 dark:text-purple-300 
                             hover:scale-110 hover:-rotate-3 transition-all duration-300">
              <i class="fas fa-search text-3xl mb-2 block"></i>Scan
            </a>
            <a href="#" class="p-6 bg-pink-100 dark:bg-pink-900/50 rounded-2xl text-center 
                             font-bold text-pink-700 dark:text-pink-300 
                             hover:scale-110 hover:-rotate-3 transition-all duration-300">
              <i class="fas fa-trophy text-3xl mb-2 block"></i>Rankings
            </a>
            <a href="#" class="p-6 bg-emerald-100 dark:bg-emerald-900/50 rounded-2xl text-center 
                             font-bold text-emerald-700 dark:text-emerald-300 
                             hover:scale-110 hover:-rotate-3 transition-all duration-300">
              <i class="fas fa-user-friends text-3xl mb-2 block"></i>Crew
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MATRIX RAIN – Only in Dark Mode -->
<script>
  if (document.documentElement.classList.contains('dark')) {
    const canvas = document.getElementById('matrix-bg');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const matrix = "01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホ";
    const fontSize = 16;
    const columns = canvas.width / fontSize;
    const drops = Array(Math.floor(columns)).fill(1);

    function draw() {
      ctx.fillStyle = 'rgba(0,0,0,0.05)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#00ff41';
      ctx.font = fontSize + 'px monospace';

      for (let i = 0; i < drops.length; i++) {
        const text = matrix[Math.floor(Math.random() * matrix.length)];
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
        drops[i]++;
      }
    }
    setInterval(draw, 35);
  }
</script>
{% endblock %}