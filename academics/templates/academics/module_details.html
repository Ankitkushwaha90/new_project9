{% extends 'base.html' %}
{% load static %}

{% block title %}{{ module.title }} - {{ module.subject.course.name }} - ProHacker Academy{% endblock %}

{% block content %}
<div class="min-h-screen py-12">
  <!-- Breadcrumb -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-10">
    <nav class="flex items-center space-x-3 text-sm font-medium">
      <a href="{% url 'courses:courses_list' %}" 
         class="text-gray-500 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-cyan-400 transition-colors">
        Courses
      </a>
      <i class="fas fa-chevron-right text-gray-400 dark:text-gray-500 text-xs"></i>
      <a href="{{ module.subject.course.get_absolute_url }}" 
         class="text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-cyan-400 transition-colors truncate max-w-xs">
        {{ module.subject.course.name }}
      </a>
      <i class="fas fa-chevron-right text-gray-400 dark:text-gray-500 text-xs"></i>
      <span class="text-indigo-600 dark:text-cyan-400 font-bold">{{ module.title }}</span>
    </nav>
  </div>

  <!-- Main Grid Layout -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12">

      <!-- Main Content Area (9/12) -->
      <article class="lg:col-span-9 space-y-10">

        <!-- Module Title -->
        <h1 class="text-4xl sm:text-5xl font-bold text-gray-900 dark:text-white leading-tight">
          {{ module.title }}
        </h1>

        <!-- Thumbnail (if exists) -->
        {% if module.thumbnail %}
          <div class="relative overflow-hidden rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 group">
            <img src="{{ module.thumbnail.url }}"
                 alt="{{ module.title }}"
                 class="w-full object-cover max-h-96 transition-transform duration-700 group-hover:scale-105">
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
          </div>
        {% endif %}

        <!-- Module Content (Rich Text) -->
        <div class="prose prose-lg dark:prose-invert max-w-none 
                    bg-white dark:bg-gray-800/90 
                    backdrop-blur-sm 
                    border border-gray-200 dark:border-gray-700 
                    rounded-2xl p-8 md:p-12 shadow-xl 
                    prose-headings:text-gray-900 dark:prose-headings:text-white 
                    prose-a:text-indigo-600 dark:prose-a:text-cyan-400 
                    prose-strong:text-gray-900 dark:prose-strong:text-white
                    prose-code:bg-gray-100 dark:prose-code:bg-gray-900 
                    prose-code:text-indigo-700 dark:prose-code:text-cyan-300 
                    prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:font-mono prose-code:text-sm
                    prose-pre:bg-gray-900 dark:prose-pre:bg-black prose-pre:border prose-pre:border-gray-700">
          {{ module.content|safe }}
        </div>

        <!-- Back Button -->
        <div class="flex items-center gap-6">
          <a href="{{ module.subject.course.get_absolute_url }}"
             class="inline-flex items-center px-7 py-4 
                    bg-gradient-to-r from-indigo-600 to-purple-600 
                    hover:from-indigo-700 hover:to-purple-700 
                    text-white font-bold text-lg rounded-xl 
                    shadow-xl hover:shadow-2xl 
                    transition-all duration-300 transform hover:-translate-y-1">
            <i class="fas fa-arrow-left mr-3"></i>
            Back to {{ module.subject.course.name }}
          </a>
        </div>
      </article>

      <!-- Sidebar (3/12) - Sticky on Large Screens -->
      <aside class="lg:col-span-3">
        <div class="sticky top-24 space-y-6">

          <!-- Course Summary Card -->
          <div class="bg-gradient-to-br from-indigo-600/10 to-cyan-600/10 
                      dark:from-indigo-900/30 dark:to-cyan-900/30 
                      border border-indigo-500/30 dark:border-cyan-500/30 
                      rounded-2xl p-6 backdrop-blur-sm">
            <h3 class="text-xl font-bold text-indigo-600 dark:text-cyan-400 mb-4 flex items-center gap-2">
              <i class="fas fa-book-open"></i> Course
            </h3>
            <p class="text-2xl font-bold text-gray-900 dark:text-white">
              {{ module.subject.course.name }}
            </p>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
              Subject: <span class="font-semibold text-indigo-600 dark:text-cyan-400">{{ module.subject.title }}</span>
            </p>
            <div class="mt-5 pt-5 border-t border-indigo-300 dark:border-cyan-800">
              <p class="text-xs text-gray-500 dark:text-gray-400 font-mono">
                Module {{ module.order|add:1 }} / {{ module.subject.modules.count }}
              </p>
            </div>
          </div>

          <!-- Module Details -->
          <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
            <h4 class="font-bold text-gray-900 dark:text-white mb-5 text-lg">Module Details</h4>
            <dl class="space-y-4 text-sm">
              <div class="flex justify-between">
                <dt class="text-gray-600 dark:text-gray-400">Duration</dt>
                <dd class="font-mono text-indigo-600 dark:text-cyan-400 font-semibold">
                  {% if module.duration %}{{ module.duration }}{% else %}~45 mins{% endif %}
                </dd>
              </div>
              <div class="flex justify-between">
                <dt class="text-gray-600 dark:text-gray-400">Difficulty</dt>
                <dd class="font-mono text-indigo-600 dark:text-cyan-400 font-semibold">
                  {% if module.level %}{{ module.level }}{% else %}Advanced{% endif %}
                </dd>
              </div>
              <div class="flex justify-between">
                <dt class="text-gray-600 dark:text-gray-400">Updated</dt>
                <dd class="font-mono text-xs text-gray-500 dark:text-gray-500">
                  {{ module.updated_at|date:"M d, Y" }}
                </dd>
              </div>
            </dl>
          </div>

          <!-- Terminal Easter Egg -->
          <div class="bg-black/95 border border-green-500/50 rounded-xl p-5 font-mono text-xs text-green-400 shadow-2xl overflow-hidden">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-red-500">root</span>@<span class="text-cyan-400">prohacker</span>:<span class="text-blue-400">~</span>$
            </div>
            <div class="animate-pulse">Stay in the shadows. Exploit responsibly.</div>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>
{% endblock %}

<!-- Optional: Remove extra_css block entirely or keep only if you add custom animations later -->
{% block extra_css %}{% endblock %}